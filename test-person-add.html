<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Person Hinzufügen Test</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div style="padding: 20px;">
        <h1>Person Hinzufügen - Test</h1>

        <div style="margin: 20px 0;">
            <h2>Gutschriften Test</h2>
            <button class="btn-primary" onclick="testShowCreditModal()">
                + Person für Gutschriften hinzufügen
            </button>
        </div>

        <div style="margin: 20px 0;">
            <h2>Schuldbuch Test</h2>
            <button class="btn-primary" onclick="testShowDebtorModal()">
                + Person für Schuldbuch hinzufügen
            </button>
        </div>

        <div style="margin: 20px 0; background: #f0f0f0; padding: 15px; border-radius: 5px;">
            <h3>Console Output:</h3>
            <div id="console-output" style="background: white; padding: 10px; min-height: 100px; font-family: monospace; white-space: pre-wrap;"></div>
        </div>
    </div>

    <!-- Credit Modal (kopiert aus index.html) -->
    <div class="modal" id="credit-modal">
        <div class="modal-content">
            <h3>Person hinzufügen / Guthaben aufladen</h3>
            <form id="credits-form">
                <div class="form-group">
                    <label for="person-name">Name der Person *</label>
                    <input type="text" id="person-name" name="person-name" required placeholder="z.B. Max Mustermann">
                </div>
                <div class="form-group">
                    <label for="credit-amount">Betrag (€) *</label>
                    <input type="number" id="credit-amount" name="credit-amount" step="0.50" min="0" required placeholder="10.00">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="testCloseCreditModal()">Abbrechen</button>
                    <button type="submit" class="btn-confirm">Aufladen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Debtor Modal -->
    <div class="modal" id="debtor-modal">
        <div class="modal-content">
            <h3>Schuldner hinzufügen</h3>
            <form id="debtor-form">
                <div class="form-group">
                    <label for="debtor-name">Name der Person *</label>
                    <input type="text" id="debtor-name" name="debtor-name" required placeholder="z.B. Max Mustermann">
                </div>
                <div class="form-group">
                    <label for="initial-debt">Initiale Schuld (€, optional)</label>
                    <input type="number" id="initial-debt" name="initial-debt" step="0.50" min="0" placeholder="0.00">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="testCloseDebtorModal()">Abbrechen</button>
                    <button type="submit" class="btn-confirm">Hinzufügen</button>
                </div>
            </form>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // Redirect console.log to screen
        const consoleDiv = document.getElementById('console-output');
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleDiv.textContent += args.join(' ') + '\n';
        };

        console.log('=== TEST PAGE LOADED ===');

        function testShowCreditModal() {
            console.log('testShowCreditModal called');
            const modal = document.getElementById('credit-modal');
            if (modal) {
                modal.classList.add('show');
                console.log('Modal should now be visible');
            } else {
                console.log('ERROR: Modal not found!');
            }
        }

        function testCloseCreditModal() {
            console.log('testCloseCreditModal called');
            const modal = document.getElementById('credit-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        function testShowDebtorModal() {
            console.log('testShowDebtorModal called');
            const modal = document.getElementById('debtor-modal');
            if (modal) {
                modal.classList.add('show');
                console.log('Debtor modal should now be visible');
            } else {
                console.log('ERROR: Debtor modal not found!');
            }
        }

        function testCloseDebtorModal() {
            console.log('testCloseDebtorModal called');
            const modal = document.getElementById('debtor-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // Test form submissions
        document.getElementById('credits-form').addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Credits form submitted!');
            const formData = new FormData(e.target);
            console.log('Name:', formData.get('person-name'));
            console.log('Amount:', formData.get('credit-amount'));
            testCloseCreditModal();
            alert('Formular würde jetzt abgesendet werden. In der echten App würde die Person hinzugefügt.');
        });

        document.getElementById('debtor-form').addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Debtor form submitted!');
            const formData = new FormData(e.target);
            console.log('Name:', formData.get('debtor-name'));
            console.log('Initial debt:', formData.get('initial-debt'));
            testCloseDebtorModal();
            alert('Formular würde jetzt abgesendet werden. In der echten App würde die Person hinzugefügt.');
        });

        console.log('=== ALL EVENT LISTENERS ATTACHED ===');
    </script>
</body>
</html>